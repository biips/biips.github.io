<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
<title>mcmcarray-object. Rbiips 0.10.0</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="author" content="">

<link href="css/bootstrap.css" rel="stylesheet">
<link href="css/bootstrap-responsive.css" rel="stylesheet">
<link href="css/highlight.css" rel="stylesheet">
<link href="css/staticdocs.css" rel="stylesheet">

<!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
  </head>

  <body>
    <div class="navbar">
  <div class="navbar-inner">
    <div class="container">
      <a class="brand" href="#">Rbiips 0.10.0</a>
      <div class="nav">
        <ul class="nav">
          <li><a href="index.html"><i class="icon-home icon-white"></i> Index</a></li>
        </ul>
      </div>
    </div>
  </div>
</div>

    <div class="container">
      <header>
        
      </header>
      
      <h1>Objects for representing MCMC output.</h1>

<div class="row">
  <div class="span8">
    <h2>Usage</h2>
    <pre><div>mcmcarray(data&nbsp;=&nbsp;NA, dim&nbsp;=&nbsp;length(data), dimnames&nbsp;=&nbsp;NULL, iteration&nbsp;=&nbsp;length(dim), chain&nbsp;=&nbsp;NA, name&nbsp;=&nbsp;"mcmcarray", lower&nbsp;=&nbsp;NULL, upper&nbsp;=&nbsp;NULL)</div>
<div>is.mcmcarray(object)</div>
<div>is.mcmcarray.list(object)</div>
<div>"biips_summary"(object, probs&nbsp;=&nbsp;c(), order&nbsp;=&nbsp;ifelse(mode, 0, 1), mode&nbsp;=&nbsp;all(object == as.integer(object)), ...)</div>
<div>"biips_summary"(object, ...)</div>
<div>"biips_table"(x, ...)</div>
<div>"biips_density"(x, bw&nbsp;=&nbsp;"nrd0", ...)</div>
<div>biips_hist(x, ...)</div>
<div>"biips_hist"(x, main&nbsp;=&nbsp;NULL, xlab&nbsp;=&nbsp;NULL, ...)</div>
<div>"biips_table"(x, ...)</div>
<div>"biips_density"(x, bw&nbsp;=&nbsp;"nrd0", ...)</div>
<div>"biips_hist"(x, main&nbsp;=&nbsp;NULL, xlab&nbsp;=&nbsp;NULL, ...)</div>
<div>"summary"(object, ...)</div>
<div>"summary"(object, ...)</div>
<div>"density"(x, ...)</div>
<div>"density"(x, ...)</div>
<div>"hist"(x, ...)</div>
<div>"hist"(x, ...)</div></pre>
    
    <h2>Arguments</h2>
    <dl>
      <dt>data</dt>
      <dd>numerical vector</dd>
      <dt>dim</dt>
      <dd>vector of integers. dimension of the array</dd>
      <dt>dimnames</dt>
      <dd>character vector</dd>
      <dt>iteration</dt>
      <dd>integer. index of the dimension corresponding to iterations
of the MCMC.</dd>
      <dt>chain</dt>
      <dd>integer. index of the dimension corresponding to chain of
the MCMC.</dd>
      <dt>name</dt>
      <dd>string. variable name</dd>
      <dt>lower</dt>
      <dd>vector of integers. variable lower bound</dd>
      <dt>upper</dt>
      <dd>vector of integers. variable upper bound</dd>
      <dt>object,x</dt>
      <dd>a <code>mcmcarray</code> or <code>mcmcarray.list</code> object.</dd>
      <dt>probs</dt>
      <dd>vector of reals. probability levels in ]0,1[ for quantiles.
(default = <code>c()</code>)</dd>
      <dt>order</dt>
      <dd>integer. Moment statistics of order below or equal to
<code>order</code> are returned. (default = 0 if all the components are discrete
variables and 1 otherwise)</dd>
      <dt>mode</dt>
      <dd>logical. Activate computation of the mode, i.e. the most
frequent value among the particles. (default = <code>TRUE</code> if all the components
are discrete variables and <code>FALSE</code> otherwise)</dd>
      <dt>...</dt>
      <dd>additional arguments to be passed to the default methods. See
  <code><a href='http://www.inside-r.org/r-doc/stats/density'>density</a></code>, <code><a href='http://www.inside-r.org/r-doc/graphics/hist'>hist</a></code>,
  <code><a href='http://www.inside-r.org/r-doc/base/table'>table</a></code></dd>
      <dt>bw</dt>
      <dd>either a real with the smoothing bandwidth to be used or a string
giving a rule to choose the bandwidth. See <code><a href='http://www.inside-r.org/r-doc/stats/bandwidth'>bw.nrd</a></code>.
(default=<code>'nrd0'</code>)</dd>
      <dt>main,xlab</dt>
      <dd>plotting parameters with useful defaults.</dd>
    </dl>
    
    <div class="Value">
      <h2>Value</h2>

      <p><dl>
The methods apply identically to <code>mcmcarray</code> or
  <code>mcmcarray.list</code> objects and return a named list with the same named
  members as the input object.</p>
  
      <p>The <code>mcmcarray</code> function returns an object of class <code>mcmcarray</code>.</p>
  
      <p>The function <code>is.mcmcarray</code> returns <code>TRUE</code> if the object is
  of class <code>mcmcarray</code>.</p>
  
      <p>The function <code>is.mcmcarray.list</code> returns <code>TRUE</code> if the
  object is of class <code>mcmcarray.list</code>.</p>
  
      <p>The method <code>biips_summary</code> returns univariate marginal
  statistics. The output innermost members are objects of class
  <code>summary.mcmcarray</code>, <em>i.e.</em> lists with members:
  <dt>mean</dt><dd>mean, if <code>order>=1</code>.</dd></p>
  
      <p><dt>var</dt><dd>variance, if <code>order>=2</code>.</dd></p>
  
      <p><dt>skew</dt><dd>skewness, if <code>order>=3</code>.</dd></p>
  
      <p><dt>kurt</dt><dd>kurtosis, if <code>order>=4</code>.</dd></p>
  
      <p><dt>probs</dt><dd>vector of quantile probabilities.</dd></p>
  
      <p><dt>quant</dt><dd>list of quantile values, if <code>probs</code> is not empty.</dd></p>
  
      <p><dt>mode</dt><dd>most frequent values for discrete components.</dd></p>
  
      <p>The method <code>biips_table</code> returns univariate marginal frequency
  tables or probability mass estimates of discrete variables. The output
  innermost members are objects of class <code>table.mcmcarray</code>.</p>
  
      <p>The method <code>biips_density</code> returns univariate marginal kernel
  density estimates. The output innermost members are objects of class
  <code>density.mcmcarray</code>.</p>
  
      <p>The method <code>summary</code> is an alias for <code>biips_summary</code>.</p>
  
      <p>The method <code>density</code> is an alias for <code>biips_density</code>.</p>
  
      <p>The method <code>hist</code> is an alias for <code>biips_hist</code>.
</dl></p>
  
    </div>

    <div class="Description">
      <h2>Description</h2>

      <p>A <code>mcmcarray</code> object is returned by the
  <code><a href='pimh-object.html'>biips_pimh_samples</a></code> or <code><a href='pmmh-object.html'>biips_pmmh_samples</a></code>
  functions to represent MCMC output of a given variable.</p>
  
      <p>A <code>mcmcarray.list</code> object is a named list of <code>mcmcarray</code> objects
  for different monitored variables.</p>
  
      <p>The methods apply identically to <code>mcmcarray</code> or <code>mcmcarray.list</code>
  objects and return a named list with the same named members as the input
  object.</p>
  
    </div>
    
    <h2 id="examples">Examples</h2>
    <pre class="examples"><div class='input'>modelfile &lt;- system.file(&#39;extdata&#39;, &#39;hmm.bug&#39;, package = &#39;Rbiips&#39;)
stopifnot(nchar(modelfile) &gt; 0)
cat(readLines(modelfile), sep = &#39;\n&#39;)
</div>
<div class='output'>var c_true[tmax], x_true[tmax], c[tmax], x[tmax], y[tmax]

data
{
  x_true[1] ~ dnorm(0, 1/5)
  y[1] ~ dnorm(x_true[1], exp(logtau_true))
  for (t in 2:tmax)
  {
    c_true[t] ~ dcat(p)
    x_true[t] ~ dnorm(0.5*x_true[t-1]+25*x_true[t-1]/(1+x_true[t-1]^2)+8*cos(1.2*(t-1)), ifelse(c_true[t]==1, 1/10, 1/100))
    y[t] ~ dnorm(x_true[t]/4, exp(logtau_true))
  }
}

model
{
  logtau ~ dunif(-3, 3)
  x[1] ~ dnorm(0, 1/5)
  y[1] ~ dnorm(x[1], exp(logtau))
  for (t in 2:tmax)
  {
    c[t] ~ dcat(p)
    x[t] ~ dnorm(0.5*x[t-1]+25*x[t-1]/(1+x[t-1]^2)+8*cos(1.2*(t-1)), ifelse(c[t]==1, 1/10, 1/100))
    y[t] ~ dnorm(x[t]/4, exp(logtau))
  }
}
</div>
<div class='input'>
#&#39; # PIMH algorithm
data &lt;- list(tmax = 10, p = c(.5, .5), logtau_true = log(1), logtau = log(1))
model &lt;- biips_model(modelfile, data, sample_data = TRUE)
</div>
<div class='output'>* Parsing model in: /home/adrien-alea/workspace/biips-git/Rbiips/inst/extdata/hmm.bug
* Compiling data graph
  Declaring variables
  Resolving undeclared variables
  Allocating nodes
  Graph size: 169
  Sampling data
  Reading data back into data table
* Compiling model graph
  Declaring variables
  Resolving undeclared variables
  Allocating nodes
  Graph size: 180
</div>
<div class='input'>
n_part &lt;- 50
obj_pimh &lt;- biips_pimh_init(model, c(&#39;x&#39;, &#39;c[2:10]&#39;))  # Initialize
</div>
<div class='output'>* Initializing PIMH
</div>
<div class='input'>out_pimh_burn &lt;- biips_pimh_update(obj_pimh, 100, n_part)  # Burn-in
</div>
<div class='output'>* Updating PIMH with 50 particles
  |--------------------------------------------------| 100%
  |**************************************************| 100 iterations in 0.41 s
</div>
<div class='input'>out_pimh &lt;- biips_pimh_samples(obj_pimh, 100, n_part)  # Samples
</div>
<div class='output'>* Generating PIMH samples with 50 particles
  |--------------------------------------------------| 100%
  |**************************************************| 100 iterations in 0.41 s
</div>
<div class='input'>
#&#39; Manipulate `mcmcarray.list` object
is.mcmcarray.list(out_pimh)
</div>
<div class='output'>[1] TRUE
</div>
<div class='input'>names(out_pimh)
</div>
<div class='output'>[1] &quot;log_marg_like&quot; &quot;x&quot;             &quot;c[2:10]&quot;      
</div>
<div class='input'>out_pimh
</div>
<div class='output'>x mcmcarray:
$mean
 [1]   3.7658240   9.9744222   3.5036537   1.4315588  15.3733341  17.0442690  12.0612049  -0.5226016 -22.1609710  -2.7569786

Marginalizing over: iteration(100) 

c[2:10] mcmcarray:
$mode
[1] 1 1 1 2 1 1 2 2 2

Marginalizing over: iteration(100) 

</div>
<div class='input'>biips_summary(out_pimh)
</div>
<div class='output'>x mcmcarray:
$mean
 [1]   3.7658240   9.9744222   3.5036537   1.4315588  15.3733341  17.0442690  12.0612049  -0.5226016 -22.1609710  -2.7569786

Marginalizing over: iteration(100) 

c[2:10] mcmcarray:
$mode
[1] 1 1 1 2 1 1 2 2 2

Marginalizing over: iteration(100) 

</div>
<div class='input'>
#&#39; Manipulate `mcmcarray` object
is.mcmcarray(out_pimh$x)
</div>
<div class='output'>[1] TRUE
</div>
<div class='input'>out_pimh$x
</div>
<div class='output'>mcmcarray:
$mean
 [1]   3.7658240   9.9744222   3.5036537   1.4315588  15.3733341  17.0442690  12.0612049  -0.5226016 -22.1609710  -2.7569786

Marginalizing over: iteration(100) 
</div>
<div class='input'>summ_pimh_x &lt;- biips_summary(out_pimh$x, order = 2, probs = c(0.025, 0.975))
summ_pimh_x
</div>
<div class='output'>mcmcarray:
$mean
 [1]   3.7658240   9.9744222   3.5036537   1.4315588  15.3733341  17.0442690  12.0612049  -0.5226016 -22.1609710  -2.7569786

$var
 [1]  0.8872088 10.8386658  4.5787192  4.7073087 12.8044568 11.3575904  7.8772475  6.7583783 12.7536591 20.3908009

$probs
[1] 0.025 0.975

$quant
$quant$`0.025`
 [1]   2.0844597   4.1812377   0.3883413  -3.8913999   9.6226656   9.5675696   6.4169130  -4.5094333 -29.9268088 -13.4596347

$quant$`0.975`
 [1]   5.622176  15.395099   7.762928   4.623164  22.247219  23.606484  16.936229   6.582560 -16.840468   5.546838


Marginalizing over: iteration(100) 
</div>
<div class='input'>dens_pimh_x &lt;- biips_density(out_pimh$x)
par(mfrow = c(2, 2))
plot(dens_pimh_x)
</div>
<p><img src='mcmcarray-object-26.png' alt='' width='540' height='400' /></p>
<p><img src='mcmcarray-object-27.png' alt='' width='540' height='400' /></p>
<div class='input'>par(mfrow = c(2, 2))
</div>
<p><img src='mcmcarray-object-29.png' alt='' width='540' height='400' /></p>
<div class='input'>biips_hist(out_pimh$x)
</div>
<p><img src='mcmcarray-object-31.png' alt='' width='540' height='400' /></p>
<p><img src='mcmcarray-object-32.png' alt='' width='540' height='400' /></p>
<div class='input'>
is.mcmcarray(out_pimh[[&#39;c[2:10]&#39;]])
</div>
<div class='output'>[1] TRUE
</div>
<div class='input'>out_pimh[[&#39;c[2:10]&#39;]]
</div>
<div class='output'>mcmcarray:
$mode
[1] 1 1 1 2 1 1 2 2 2

Marginalizing over: iteration(100) 
</div>
<div class='input'>summ_pimh_c &lt;- biips_summary(out_pimh[[&#39;c[2:10]&#39;]])
summ_pimh_c
</div>
<div class='output'>mcmcarray:
$mode
[1] 1 1 1 2 1 1 2 2 2

Marginalizing over: iteration(100) 
</div>
<div class='input'>table_pimh_c &lt;- biips_table(out_pimh[[&#39;c[2:10]&#39;]])
par(mfrow = c(2, 2))
</div>
<p><img src='mcmcarray-object-40.png' alt='' width='540' height='400' /></p>
<div class='input'>plot(table_pimh_c)
</div>
<p><img src='mcmcarray-object-42.png' alt='' width='540' height='400' /></p>
<p><img src='mcmcarray-object-43.png' alt='' width='540' height='400' /></p>
<div class='input'>
#&#39; # PMMH algorithm
data &lt;- list(tmax = 10, p = c(.5, .5), logtau_true = log(1))
model &lt;- biips_model(modelfile, data)
</div>
<div class='output'>* Parsing model in: /home/adrien-alea/workspace/biips-git/Rbiips/inst/extdata/hmm.bug
* Compiling data graph
  Declaring variables
  Resolving undeclared variables
  Allocating nodes
  Graph size: 168
  Sampling data
  Reading data back into data table
* Compiling model graph
  Declaring variables
  Resolving undeclared variables
  Allocating nodes
  Graph size: 180
</div>
<div class='input'>
n_part &lt;- 50
obj_pmmh &lt;- biips_pmmh_init(model, &#39;logtau&#39;, latent_names = c(&#39;x&#39;, &#39;c[2:10]&#39;),
                            inits = list(logtau = -2))  # Initialize
</div>
<div class='output'>* Initializing PMMH
</div>
<div class='input'>out_pmmh_burn &lt;- biips_pmmh_update(obj_pmmh, 100, n_part)  # Burn-in
</div>
<div class='output'>* Adapting PMMH with 50 particles
  |--------------------------------------------------| 100%
  |++++++++++++++++++++++++++++++++++++++++++++++++++| 100 iterations in 0.47 s
</div>
<div class='input'>out_pmmh &lt;- biips_pmmh_samples(obj_pmmh, 100, n_part, thin = 1)  # Samples
</div>
<div class='output'>* Generating 100 PMMH samples with 50 particles
  |--------------------------------------------------| 100%
  |**************************************************| 100 iterations in 0.45 s
</div>
<div class='input'>
#&#39; Manipulate `mcmcarray.list` object
is.mcmcarray.list(out_pmmh)
</div>
<div class='output'>[1] TRUE
</div>
<div class='input'>names(out_pmmh)
</div>
<div class='output'>[1] &quot;log_marg_like_pen&quot; &quot;logtau&quot;            &quot;x&quot;                 &quot;c[2:10]&quot;          
</div>
<div class='input'>out_pmmh
</div>
<div class='output'>logtau mcmcarray:
$mean
[1] 1.838985

Marginalizing over: iteration(100) 

x mcmcarray:
$mean
 [1]  0.7139138 10.6331769  7.5971262  1.9010691 16.5068751 18.7990781  2.7335623  9.5677346  3.6704171 16.4285854

Marginalizing over: iteration(100) 

c[2:10] mcmcarray:
$mode
[1] 1 1 1 1 1 2 1 1 2

Marginalizing over: iteration(100) 

</div>
<div class='input'>biips_summary(out_pmmh)
</div>
<div class='output'>logtau mcmcarray:
$mean
[1] 1.838985

Marginalizing over: iteration(100) 

x mcmcarray:
$mean
 [1]  0.7139138 10.6331769  7.5971262  1.9010691 16.5068751 18.7990781  2.7335623  9.5677346  3.6704171 16.4285854

Marginalizing over: iteration(100) 

c[2:10] mcmcarray:
$mode
[1] 1 1 1 1 1 2 1 1 2

Marginalizing over: iteration(100) 

</div>
<div class='input'>
#&#39; Manipulate `mcmcarray` object
is.mcmcarray(out_pmmh$logtau)
</div>
<div class='output'>[1] TRUE
</div>
<div class='input'>out_pmmh$logtau
</div>
<div class='output'>mcmcarray:
$mean
[1] 1.838985

Marginalizing over: iteration(100) 
</div>
<div class='input'>summ_pmmh_lt &lt;- biips_summary(out_pmmh$logtau, order = 2, probs = c(0.025, 0.975))
dens_pmmh_lt &lt;- biips_density(out_pmmh$logtau)
par(mfrow = c(2, 1))
</div>
<p><img src='mcmcarray-object-65.png' alt='' width='540' height='400' /></p>
<div class='input'>plot(dens_pmmh_lt)
biips_hist(out_pmmh$logtau)
</div>
<p><img src='mcmcarray-object-67.png' alt='' width='540' height='400' /></p>
<div class='input'>
is.mcmcarray(out_pmmh$x)
</div>
<div class='output'>[1] TRUE
</div>
<div class='input'>out_pmmh$x
</div>
<div class='output'>mcmcarray:
$mean
 [1]  0.7139138 10.6331769  7.5971262  1.9010691 16.5068751 18.7990781  2.7335623  9.5677346  3.6704171 16.4285854

Marginalizing over: iteration(100) 
</div>
<div class='input'>summ_pmmh_x &lt;- biips_summary(out_pmmh$x, order = 2, probs = c(0.025, 0.975))
dens_pmmh_x &lt;- biips_density(out_pmmh$x)
par(mfrow = c(2, 2))
plot(dens_pmmh_x)
</div>
<p><img src='mcmcarray-object-73.png' alt='' width='540' height='400' /></p>
<p><img src='mcmcarray-object-74.png' alt='' width='540' height='400' /></p>
<div class='input'>par(mfrow = c(2, 2))
</div>
<p><img src='mcmcarray-object-76.png' alt='' width='540' height='400' /></p>
<div class='input'>biips_hist(out_pmmh$x)
</div>
<p><img src='mcmcarray-object-78.png' alt='' width='540' height='400' /></p>
<p><img src='mcmcarray-object-79.png' alt='' width='540' height='400' /></p>
<div class='input'>
is.mcmcarray(out_pmmh[[&#39;c[2:10]&#39;]])
</div>
<div class='output'>[1] TRUE
</div>
<div class='input'>out_pmmh[[&#39;c[2:10]&#39;]]
</div>
<div class='output'>mcmcarray:
$mode
[1] 1 1 1 1 1 2 1 1 2

Marginalizing over: iteration(100) 
</div>
<div class='input'>summ_pmmh_c &lt;- biips_summary(out_pmmh[[&#39;c[2:10]&#39;]])
table_pmmh_c &lt;- biips_table(out_pmmh[[&#39;c[2:10]&#39;]])
par(mfrow = c(2, 2))
</div>
<p><img src='mcmcarray-object-85.png' alt='' width='540' height='400' /></p>
<div class='input'>plot(table_pmmh_c)
</div>
<p><img src='mcmcarray-object-87.png' alt='' width='540' height='400' /></p>
<p><img src='mcmcarray-object-88.png' alt='' width='540' height='400' /></p>
<p><img src='mcmcarray-object-89.png' alt='' width='540' height='400' /></p></pre>
  </div>
  <div class="span4">
    <!-- <ul>
      <li>biips_density.mcmcarray</li><li>biips_density.mcmcarray.list</li><li>biips_hist</li><li>biips_hist.mcmcarray</li><li>biips_hist.mcmcarray.list</li><li>biips_summary.mcmcarray</li><li>biips_summary.mcmcarray.list</li><li>biips_table.mcmcarray</li><li>biips_table.mcmcarray.list</li><li>density.mcmcarray</li><li>density.mcmcarray.list</li><li>hist.mcmcarray</li><li>hist.mcmcarray.list</li><li>is.mcmcarray</li><li>is.mcmcarray.list</li><li>mcmcarray</li><li>mcmcarray-object</li><li>mcmcarray.list</li><li>mcmcarray.list-object</li><li>summary.mcmcarray</li><li>summary.mcmcarray.list</li>
    </ul>
    <ul>
      
    </ul> -->
      
    <h2>See also</h2>
    
<code><a href='http://www.inside-r.org/r-doc/stats/density'>density</a></code>

        
  </div>
</div>
      
      <footer>
      <p class="pull-right"><a href="#">Back to top</a></p>
<p>Built by <a href="https://github.com/hadley/staticdocs">staticdocs</a>. Styled with <a href="http://twitter.github.com/bootstrap">bootstrap</a>.</p>
      </footer>
    </div>
  </body>
</html>